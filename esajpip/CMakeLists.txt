
PROJECT(esajpip)

SET(ESAJPIP_TOP esajpip/src)
AUX_SOURCE_DIRECTORY(${ESAJPIP_TOP}/data     DATA_SRCS)
AUX_SOURCE_DIRECTORY(${ESAJPIP_TOP}/http     HTTP_SRCS)
AUX_SOURCE_DIRECTORY(${ESAJPIP_TOP}/ipc      IPC_SRCS)
AUX_SOURCE_DIRECTORY(${ESAJPIP_TOP}/jpeg2000 JPEG2000_SRCS)
AUX_SOURCE_DIRECTORY(${ESAJPIP_TOP}/jpip     JPIP_SRCS)
AUX_SOURCE_DIRECTORY(${ESAJPIP_TOP}/net      NET_SRCS)
SET(ALL_SRCS ${DATA_SRCS} ${HTTP_SRCS} ${IPC_SRCS} ${JPEG2000_SRCS} ${JPIP_SRCS} ${NET_SRCS})

SET(CORE_SRCS
	base.cc
    trace.cc
	app_info.cc
	app_config.cc
	args_parser.cc
	client_info.cc
	client_manager.cc)

FOREACH(SRC ${CORE_SRCS})
    SET(APP_SRCS ${APP_SRCS} ${ESAJPIP_TOP}/${SRC})
ENDFOREACH(SRC)

ADD_DEFINITIONS(-D_NO_READPROC -D_NO_FAST_FILE)
IF(CMAKE_SYSTEM_NAME STREQUAL "Linux")
  ADD_DEFINITIONS(-D_PLATFORM_LINUX)
ENDIF(CMAKE_SYSTEM_NAME STREQUAL "Linux")

INCLUDE_DIRECTORIES(BEFORE . ${ESAJPIP_TOP} ${LIBCONFIG}/lib ${LOG4CPP}/include)
ADD_EXECUTABLE(esajpip ${ESAJPIP_TOP}/esa_jpip_server.cc ${APP_SRCS} ${ALL_SRCS})
TARGET_LINK_LIBRARIES(esajpip config++ log4cpp)
INSTALL(TARGETS esajpip DESTINATION ".")
